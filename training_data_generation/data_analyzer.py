#!/usr/bin/env python

import csv

ip_index = [39,57,68,75,90,127,129,132,155,170,171,172,173,174,175,176,177,178,180,181,192,193,198,202,210,215,216,217,218,222,229,291,319,325,336,338,339,344,351,376,386,235,332,360,381,373,58,7,59,56,321,211,262,209,320,353,160,156,212,151,343,66,341,61,63,147,317,334,374,87,152,249,144,76,162,322,185,183,69,22,23,37,383,328,361,184,21,24,128,380,188,159,60,20,190,19,362,231,207,64,333,382,257,358,368,370,347,124,371,301,377,369,29,93,356,260,27,143,80,13,372,293,33,346,189,221,126,32,390,290,51,299,205,137,357,28,25,134,224,139,261,149,273,52,85,140,154,220,342,135,34,219,26,133,138,148,53,153,203,324,136,18,365,379,223,100,280,254,30,230,278,378,282,285,366,364,157,363,78,123,274,97,158,259,270,50,131,312,298,1,31,248,384,303,47,367,14,99,206,269,62,92,225,277,166,116,307,234,265,12,42,256,314,245,309,164,88,329,5,275,141,295,323,55,389,11,284,236,9,117,318,70,101,3,103,110,102,169,182,35,387,232,187,161,49,105,71,204,112,348,163,84,313,15,54,310,6,130,327,146,199,252,304,81,233,45,108,118,279,238,48,165,186,226,345,315,8,41,79,77,122,355,86,349,239,111,311,107,276,4,167,326,266,113,300,17,251,330,106,104,197,331,296,352,82,283,253,263,195,250,91,16,388,72,287,316,73,292,95,385,89,38,74,350,196,67,213,94,271,125,240,120,340,36,272,83,228,65,286,115,191,121,294,305,142,98,258,306,96,40,194,289,145,200,114,268,308,281,208,359,119,10,246,109,302,375,46,354,237,241,297,244,168,242,2,227,267,214,337,201,247,243,150,255,288,179,43,335,264,44]

selected_feature = {'branch': ['system.cpu.branchPred.condIncorrect','system.cpu.branchPred.RASInCorrect','system.cpu.branchPred.condPredicted','system.cpu.commit.branches','system.cpu.branchPred.usedRAS','system.cpu.iew.branchMispredicts','system.cpu.branchPred.lookups','system.cpu.fetch.branchRate','system.cpu.iew.exec_branches','system.cpu.branchPred.BTBLookups','system.cpu.fetch.Branches','system.cpu.branchPred.BTBHits'], 'commit': ['system.cpu.commit.committed_per_cycle::mean','system.cpu.commit.committed_per_cycle::stdev','system.cpu.committedInsts','system.cpu.commit.membars','system.cpu.commit.function_calls','system.cpu.commit.branches','system.cpu.commit.loads','system.cpu.commit.refs','system.cpu.commit.committed_per_cycle::1','system.cpu.commit.committed_per_cycle::0','system.cpu.commit.committed_per_cycle::3','system.cpu.commit.committed_per_cycle::2','system.cpu.commit.committed_per_cycle::5','system.cpu.commit.committed_per_cycle::4','system.cpu.commit.committed_per_cycle::7','system.cpu.commit.committed_per_cycle::6','system.cpu.commit.committed_per_cycle::8','system.cpu.committedInsts_total','system.cpu.committedOps','system.cpu.commit.fp_insts','system.cpu.commit.committed_per_cycle::total','system.cpu.commit.committed_per_cycle::max_value','system.cpu.commit.committedOps','system.cpu.commit.int_insts','system.cpu.commit.committed_per_cycle::samples','system.cpu.commit.bw_lim_events','system.cpu.commit.committedInsts'], 'dcache': ['system.cpu.dcache.tags.occ_task_id_blocks::1024','system.cpu.dcache.tags.occ_task_id_percent::1024','system.cpu.dcache.tags.sampled_refs','system.cpu.dcache.blocked_cycles::no_mshrs','system.cpu.dcache.tags.occ_blocks::cpu.data','system.cpu.dcache.tags.data_accesses','system.cpu.dcache.tags.tagsinuse','system.cpu.dcache.tags.occ_percent::total','system.cpu.dcache.tags.tag_accesses','system.cpu.dcache.tags.total_refs','system.cpu.dcache.tags.occ_percent::cpu.data','system.cpu.dcache.blocked::no_mshrs','system.cpu.dcache.tags.replacements'], 'decode': ['system.cpu.decode.DecodedInsts','system.cpu.decode.RunCycles'], 'fetch' : ['system.cpu.fetch.Insts','system.cpu.itb.fetch_acv','system.cpu.itb.fetch_misses','system.cpu.fetch.rateDist::stdev','system.cpu.fetch.rateDist::mean','system.cpu.fetch.rateDist::5','system.cpu.fetch.rateDist::4','system.cpu.fetch.rateDist::7','system.cpu.fetch.rateDist::6','system.cpu.fetch.rateDist::1','system.cpu.fetch.rateDist::0','system.cpu.fetch.rateDist::3','system.cpu.fetch.rateDist::2','system.cpu.fetch.rateDist::8','system.cpu.itb.fetch_hits','system.cpu.fetch.rateDist::max_value','system.cpu.fetch.rateDist::total','system.cpu.fetch.Cycles','system.cpu.fetch.rate','system.cpu.fetch.branchRate','system.cpu.fetch.rateDist::samples','system.cpu.itb.fetch_accesses','system.cpu.fetch.Branches'], 'icache' : ['system.cpu.icache.tags.data_accesses','system.cpu.icache.blocked::no_targets','system.cpu.icache.tags.total_refs','system.cpu.icache.tags.occ_blocks::cpu.inst','system.cpu.icache.tags.occ_percent::cpu.inst','system.cpu.icache.blocked_cycles::no_targets','system.cpu.icache.tags.tag_accesses','system.cpu.icache.tags.tagsinuse','system.cpu.icache.blocked::no_mshrs','system.cpu.icache.tags.occ_task_id_percent::1024','system.cpu.icache.tags.occ_task_id_blocks::1024','system.cpu.icache.tags.occ_percent::total','system.cpu.icache.blocked_cycles::no_mshrs','system.cpu.icache.tags.replacements','system.cpu.icache.tags.sampled_refs'], 'iew':  ['system.cpu.iew.wb_consumers','system.cpu.iew.iewDispNonSpecInsts','system.cpu.iew.lsq.thread0.cacheBlocked','system.cpu.iew.exec_refs','system.cpu.iew.iewIQFullEvents','system.cpu.iew.predictedNotTakenIncorrect','system.cpu.iew.iewBlockCycles','system.cpu.iew.iewExecLoadInsts','system.cpu.iew.branchMispredicts','system.cpu.iew.lsq.thread0.memOrderViolation','system.cpu.iew.lsq.thread0.squashedLoads','system.cpu.iew.wb_producers','system.cpu.iew.iewSquashCycles','system.cpu.iew.exec_rate','system.cpu.iew.wb_rate','system.cpu.iew.memOrderViolationEvents','system.cpu.iew.iewDispStoreInsts','system.cpu.iew.iewUnblockCycles','system.cpu.iew.iewExecutedInsts','system.cpu.iew.iewExecSquashedInsts','system.cpu.iew.wb_count','system.cpu.iew.iewDispSquashedInsts','system.cpu.iew.lsq.thread0.squashedStores','system.cpu.iew.predictedTakenIncorrect','system.cpu.iew.iewLSQFullEvents','system.cpu.iew.lsq.thread0.rescheduledLoads','system.cpu.iew.exec_nop','system.cpu.iew.exec_branches','system.cpu.iew.iewDispatchedInsts','system.cpu.iew.wb_sent','system.cpu.iew.exec_stores','system.cpu.iew.lsq.thread0.forwLoads','system.cpu.iew.iewDispLoadInsts','system.cpu.iew.lsq.thread0.ignoredResponses'], 'inst': ['system.cpu.rename.tempSerializingInsts','system.cpu.iew.iewDispNonSpecInsts','sim_insts','system.cpu.fetch.Insts','system.cpu.committedInsts','system.cpu.rename.serializingInsts','system.cpu.iew.iewExecLoadInsts','system.cpu.committedInsts_total','system.cpu.decode.DecodedInsts','system.cpu.commit.fp_insts','system.cpu.iew.iewDispStoreInsts','system.cpu.iew.iewExecutedInsts','system.cpu.iew.iewExecSquashedInsts','system.cpu.iq.iqInstsIssued','system.cpu.rename.skidInsts','system.cpu.iew.iewDispSquashedInsts','system.cpu.commit.int_insts','system.cpu.iew.iewDispatchedInsts','system.cpu.commit.committedInsts','system.cpu.rename.RenamedInsts','system.cpu.iew.iewDispLoadInsts'], 'inst_special': ['system.cpu.rename.tempSerializingInsts','system.cpu.iew.iewDispNonSpecInsts','system.cpu.fetch.Insts','system.cpu.committedInsts','system.cpu.rename.serializingInsts','system.cpu.iew.iewExecLoadInsts','system.cpu.committedInsts_total','system.cpu.decode.DecodedInsts','system.cpu.commit.fp_insts','system.cpu.iew.iewDispStoreInsts','system.cpu.iew.iewExecutedInsts','system.cpu.iew.iewExecSquashedInsts','system.cpu.iq.iqInstsIssued','system.cpu.rename.skidInsts','system.cpu.iew.iewDispSquashedInsts','system.cpu.commit.int_insts','system.cpu.iew.iewDispatchedInsts','system.cpu.commit.committedInsts','system.cpu.rename.RenamedInsts','system.cpu.iew.iewDispLoadInsts'], 'l2': ['system.l2.tags.tag_accesses','system.l2.tags.data_accesses','system.l2.tags.tagsinuse','system.l2.tags.occ_task_id_blocks::1024','system.l2.tags.sampled_refs','system.l2.tags.occ_percent::total','system.l2.tags.total_refs','system.tol2bus.snoop_data_through_bus','system.l2.tags.occ_percent::writebacks','system.l2.tags.occ_percent::cpu.data','system.l2.tags.occ_blocks::cpu.data','system.tol2bus.data_through_bus','system.tol2bus.throughput','system.l2.tags.occ_blocks::writebacks','system.l2.tags.occ_task_id_percent::1024','system.l2.tags.replacements'], 'mem': ['system.mem_ctrls.busUtil','system.mem_ctrls.readPktSize::6','system.mem_ctrls.wrQLenPdf::22','system.mem_ctrls.wrQLenPdf::40','system.mem_ctrls.wrQLenPdf::41','system.mem_ctrls.wrQLenPdf::42','system.mem_ctrls.wrQLenPdf::43','system.mem_ctrls.wrQLenPdf::44','system.mem_ctrls.wrQLenPdf::45','system.mem_ctrls.perBankRdBursts::8','system.mem_ctrls.perBankRdBursts::9','system.mem_ctrls.perBankRdBursts::6','system.mem_ctrls.perBankRdBursts::7','system.mem_ctrls.perBankRdBursts::4','system.mem_ctrls.perBankRdBursts::5','system.mem_ctrls.perBankRdBursts::2','system.mem_ctrls.perBankRdBursts::3','system.mem_ctrls.perBankRdBursts::0','system.mem_ctrls.perBankRdBursts::1','system.mem_ctrls.wrQLenPdf::10','system.membus.throughput','system.mem_ctrls.perBankRdBursts::10','system.mem_ctrls.perBankRdBursts::11','system.mem_ctrls.perBankRdBursts::12','system.mem_ctrls.perBankRdBursts::13','system.mem_ctrls.perBankRdBursts::15','system.mem_ctrls.rdQLenPdf::14','system.mem_ctrls.rdQLenPdf::15','system.mem_ctrls.rdQLenPdf::16','system.mem_ctrls.rdQLenPdf::17','system.mem_ctrls.rdQLenPdf::10','system.mem_ctrls.rdQLenPdf::11','system.mem_ctrls.rdQLenPdf::13','system.mem_ctrls.avgWrBWSys','system.mem_ctrls.totMemAccLat','system.mem_ctrls.totQLat','system.mem_ctrls.perBankWrBursts::0','system.mem_ctrls.prechargeAllPercent','system.mem_ctrls.busUtilRead','system.mem_ctrls.readBursts','system.mem_ctrls.readReqs','system.mem_ctrls.numWrRetry','system.mem_ctrls.perBankWrBursts::1','system.mem_ctrls.wrQLenPdf::57','system.mem_ctrls.perBankWrBursts::3','system.mem_ctrls.perBankWrBursts::2','system.mem_ctrls.perBankWrBursts::5','system.mem_ctrls.perBankWrBursts::4','system.mem_ctrls.perBankWrBursts::7','system.mem_ctrls.perBankWrBursts::6','system.mem_ctrls.perBankWrBursts::9','system.mem_ctrls.perBankWrBursts::8','system.mem_ctrls.bytesReadSys','system.mem_ctrls.wrQLenPdf::53','system.mem_ctrls.wrQLenPdf::52','system.mem_ctrls.perBankWrBursts::13','system.mem_ctrls.perBankWrBursts::12','system.membus.data_through_bus','system.mem_ctrls.wrQLenPdf::59','system.mem_ctrls.wrQLenPdf::58','system.mem_ctrls.perBankWrBursts::15','system.mem_ctrls.perBankWrBursts::14','system.mem_ctrls.wrQLenPdf::55','system.mem_ctrls.wrQLenPdf::54','system.mem_ctrls.perBankWrBursts::11','system.mem_ctrls.perBankWrBursts::10','system.mem_ctrls.wrQLenPdf::51','system.mem_ctrls.wrQLenPdf::50','system.mem_ctrls.busUtilWrite','system.mem_ctrls.readRowHits','system.mem_ctrls.wrQLenPdf::3','system.mem_ctrls.wrQLenPdf::2','system.mem_ctrls.wrQLenPdf::1','system.mem_ctrls.wrQLenPdf::0','system.mem_ctrls.wrQLenPdf::7','system.mem_ctrls.wrQLenPdf::6','system.mem_ctrls.wrQLenPdf::5','system.mem_ctrls.wrQLenPdf::4','system.mem_ctrls.wrQLenPdf::9','system.mem_ctrls.wrQLenPdf::8','system.mem_ctrls.wrQLenPdf::46','system.mem_ctrls.wrQLenPdf::47','system.mem_ctrls.wrQLenPdf::48','system.mem_ctrls.wrQLenPdf::24','system.mem_ctrls.wrQLenPdf::49','system.mem_ctrls.totBankLat','system.mem_ctrls.wrQLenPdf::62','system.mem_ctrls.wrQLenPdf::63','system.mem_ctrls.wrQLenPdf::60','system.mem_ctrls.wrQLenPdf::61','system.mem_ctrls.wrQLenPdf::13','system.mem_ctrls.wrQLenPdf::12','system.mem_ctrls.wrQLenPdf::11','system.mem_ctrls.wrQLenPdf::17','system.mem_ctrls.wrQLenPdf::16','system.mem_ctrls.wrQLenPdf::15','system.mem_ctrls.wrQLenPdf::14','system.mem_ctrls.wrQLenPdf::19','system.mem_ctrls.wrQLenPdf::18','system.mem_ctrls.avgRdBWSys','system.mem_ctrls.writePktSize::6','system.mem_ctrls.writeReqs','system.mem_ctrls.totBusLat','system.mem_ctrls.perBankRdBursts::14','system.mem_ctrls.bytesWrittenSys','system.mem_ctrls.totGap','system.mem_ctrls.wrQLenPdf::28','system.mem_ctrls.wrQLenPdf::29','system.mem_ctrls.avgRdBW','system.mem_ctrls.wrQLenPdf::23','system.mem_ctrls.wrQLenPdf::20','system.mem_ctrls.wrQLenPdf::21','system.mem_ctrls.wrQLenPdf::26','system.mem_ctrls.wrQLenPdf::27','system.mem_ctrls.wrQLenPdf::25','system.membus.snoop_data_through_bus','system.mem_ctrls.bytesWritten','system.mem_ctrls.bytesReadDRAM','system.mem_ctrls.writeBursts','system.mem_ctrls.writeRowHits','system.mem_ctrls.avgWrBW','system.mem_ctrls.rdQLenPdf::21','system.mem_ctrls.rdQLenPdf::20','system.mem_ctrls.rdQLenPdf::22','system.mem_ctrls.avgWrQLen','system.mem_ctrls.rdQLenPdf::2','system.mem_ctrls.peakBW','system.mem_ctrls.rdQLenPdf::18','system.mem_ctrls.rdQLenPdf::19','system.mem_ctrls.servicedByWrQ','system.mem_ctrls.rdQLenPdf::12','system.mem_ctrls.avgRdQLen','system.mem_ctrls.neitherReadNorWriteReqs','system.mem_ctrls.wrQLenPdf::56','system.mem_ctrls.wrQLenPdf::39','system.mem_ctrls.wrQLenPdf::38','system.mem_ctrls.wrQLenPdf::31','system.mem_ctrls.wrQLenPdf::30','system.mem_ctrls.wrQLenPdf::33','system.mem_ctrls.wrQLenPdf::32','system.mem_ctrls.wrQLenPdf::35','system.mem_ctrls.wrQLenPdf::34','system.mem_ctrls.wrQLenPdf::37','system.mem_ctrls.wrQLenPdf::36','system.mem_ctrls.rdQLenPdf::8','system.mem_ctrls.rdQLenPdf::9','system.mem_ctrls.rdQLenPdf::3','system.mem_ctrls.rdQLenPdf::0','system.mem_ctrls.rdQLenPdf::1','system.mem_ctrls.rdQLenPdf::6','system.mem_ctrls.rdQLenPdf::7','system.mem_ctrls.rdQLenPdf::4','system.mem_ctrls.rdQLenPdf::5','system.mem_ctrls.bytesReadWrQ']}

def read_data():
	with open("data_with_heading.csv", "rb") as csvfile:
		reader = csv.reader(csvfile)
		one_count = 0
		zero_count = 0
		count = 0
		for row in reader:
			count += 1
			#if count == 1:
			#	for ind in ip_index:
			#		print row[ind]	
			if row[-1] == '1':
				one_count += 1
				#one_final_tick.append(row[])
			else:
				zero_count += 1

		print "Number of data with label 1:", one_count
		print "Number of data with label 0:", zero_count

def select_data():
	with open("data_with_heading.csv", "rb") as csvfile:
		reader = csv.reader(csvfile)
		lines = []
		for row in reader:
			lines.append(row)

		for k, v in selected_feature.iteritems():
			print k 
			features = v
			count = 0
			selected_index = []
			data = []
			for row in lines:
				count += 1
				if count == 1:
					for feat in features:
						selected_index.append(row.index(feat))	
					print selected_index
				else:
					selected_row = []
					for ind in selected_index:
						selected_row.append(row[ind])	
					selected_row.append(row[-1])
					data.append(selected_row)

			file_name = "data_" + str(k) + ".csv"
			print file_name
			with open(file_name, 'wb') as csvfile:
				writer = csv.writer(csvfile)
				for row in data:
					writer.writerow(row)


if __name__ == "__main__":
	#read_data()
	select_data()
